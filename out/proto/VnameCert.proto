syntax = "proto3";

message LocalizedName {
	string lg = 1;
	string lc = 2;
	string verifiedName = 3;
}

message VerifiedNameCertificate {
	bytes details = 1;
	bytes signature = 2;
	bytes serverSignature = 3;

	message Details {
		uint64 serial = 1;
		string issuer = 2;
		string verifiedName = 4;
		repeated LocalizedName localizedNames = 8;
		uint64 issueTime = 10;
	}
}

message BizAccountPayload {
	VerifiedNameCertificate vnameCert = 1;
	bytes bizAcctLinkInfo = 2;
}

message BizAccountLinkInfo {
	uint64 whatsappBizAcctFbid = 1;
	string whatsappAcctNumber = 2;
	uint64 issueTime = 3;
	HostStorageType hostStorage = 4;
	AccountType accountType = 5;

	enum AccountType {
		ENTERPRISE = 0;
	}

	enum HostStorageType {
		ON_PREMISE = 0;
		FACEBOOK = 1;
	}
}

message BizIdentityInfo {
	VerifiedLevelValue vlevel = 1;
	VerifiedNameCertificate vnameCert = 2;
	bool signed = 3;
	bool revoked = 4;
	HostStorageType hostStorage = 5;
	ActualActorsType actualActors = 6;
	uint64 privacyModeTs = 7;
	uint64 featureControls = 8;

	enum ActualActorsType {
		SELF = 0;
		BSP = 1;
	}

	enum HostStorageType {
		ON_PREMISE = 0;
		FACEBOOK = 1;
	}

	enum VerifiedLevelValue {
		UNKNOWN = 0;
		LOW = 1;
		HIGH = 2;
	}
}