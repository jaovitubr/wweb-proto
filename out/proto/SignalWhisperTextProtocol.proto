syntax = "proto3";

message SignalMessage {
	bytes ratchetKey = 1;
	uint32 counter = 2;
	uint32 previousCounter = 3;
	bytes ciphertext = 4;
}

message PreKeySignalMessage {
	uint32 registrationId = 5;
	uint32 preKeyId = 1;
	uint32 signedPreKeyId = 6;
	bytes baseKey = 2;
	bytes identityKey = 3;
	bytes message = 4;
}

message KeyExchangeMessage {
	uint32 id = 1;
	bytes baseKey = 2;
	bytes ratchetKey = 3;
	bytes identityKey = 4;
	bytes baseKeySignature = 5;
}

message SenderKeyMessage {
	uint32 id = 1;
	uint32 iteration = 2;
	bytes ciphertext = 3;
}

message SenderKeyDistributionMessage {
	uint32 id = 1;
	uint32 iteration = 2;
	bytes chainKey = 3;
	bytes signingKey = 4;
}

message DeviceConsistencyCodeMessage {
	uint32 generation = 1;
	bytes signature = 2;
}