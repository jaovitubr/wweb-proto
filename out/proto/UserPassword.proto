syntax = "proto3";

message UserPassword {
	Encoding encoding = 1;
	Transformer transformer = 2;
	repeated TransformerArg transformerArg = 3;
	bytes transformedData = 4;

	enum Transformer {
		NONE = 0;
		PBKDF2_HMAC_SHA512 = 1;
		PBKDF2_HMAC_SHA384 = 2;
	}

	enum Encoding {
		UTF8 = 0;
		UTF8_BROKEN = 1;
	}

	message TransformerArg {
		string key = 1;
		Value value = 2;
	
		message Value {
			oneof value {
				bytes asBlob = 1;
				uint32 asUnsignedInteger = 2;
			}
		}
	}
}