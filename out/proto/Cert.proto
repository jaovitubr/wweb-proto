syntax = "proto3";

message NoiseCertificate {
	bytes details = 1;
	bytes signature = 2;

	message Details {
		uint32 serial = 1;
		string issuer = 2;
		uint64 expires = 3;
		string subject = 4;
		bytes key = 5;
	}
}

message CertChain {
	NoiseCertificate leaf = 1;
	NoiseCertificate intermediate = 2;

	message NoiseCertificate {
		bytes details = 1;
		bytes signature = 2;
	
		message Details {
			uint32 serial = 1;
			uint32 issuerSerial = 2;
			bytes key = 3;
			uint64 notBefore = 4;
			uint64 notAfter = 5;
		}
	}
}